<script setup>
  import { ref, defineEmits } from 'vue'
  import TabView from 'primevue/tabview'
  import TabPanel from 'primevue/tabpanel'
  import InputText from 'primevue/inputtext'
  import DataTable from 'primevue/datatable'
  import Column from 'primevue/column'

  const emit = defineEmits(['tab-selected'])

  // Corrected tabs array with objects
  const tabs = ref([
    { title: 'Most Viewed Stores' },
    { title: 'Cashback Stores' },
    { title: 'Travel Miles/Points' },
    { title: 'Credit Card Points' },
    { title: 'Other Reward Points' },
  ])

  const activeIndex = ref(0) // Default to the first tab

  const alphabet = ref('ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split(''))

  // Dummy Data
  const mostViewedStores = ref([
    { id: '1', store: 'America', bestRate: '4.5%' },
    { id: '2', store: 'Canada', bestRate: '4.5%' },
  ])

  const storesSortedByRewards = ref([
    { id: '1', store: 'Amazon', bestRate: '5%' },
    { id: '2', store: 'eBay', bestRate: '4%' },
  ])

  const cashbackData = ref([
    { store: 'Amazon', bestRate: '5%', beFrugal: '4.5%', extraBux: '4%' },
    { store: 'eBay', bestRate: '3%', beFrugal: '2.5%', extraBux: '2%' },
  ])

  const travelMilesData = ref([
    { store: 'Delta', bestRate: '8%', alaska: '7%', american: '6.5%' },
    { store: 'JetBlue', bestRate: '6%', alaska: '5.5%', american: '5%' },
  ])

  const creditCardPoints = ref([
    { store: 'Chase', bestRate: '10%', alaska: '8%', american: '7.5%' },
  ])

  const otherRewardPoints = ref([
    { store: 'Southwest', bestRate: '6%', alaska: '5%', american: '4.5%' },
  ])
</script>

<template>
  <div class="card">
    <TabView v-model:activeIndex="activeIndex">
      <TabPanel v-for="(tab, index) in tabs" :key="index" :header="tab.title">
        <!-- Filter Section -->
        <div class="filter-section">
          <p class="filt"><strong>Filter #</strong></p>
          <div class="letters">
            <span v-tooltip.top="'Filter by Alphabets'" v-for="letter in alphabet" :key="letter">
              {{ letter }}
            </span>
          </div>

          <!-- Search Bar -->
          <div class="filter-row">
            <div class="legend">
              <span class="gray-box"></span> Gray background marks the store's best rate for the
              reward type. <span class="green-box"></span> Green background marks the portal offers
              best rate for the store.
            </div>
            <div class="search-bar">
              <span class="p-input-icon-left">
                <InputText v-tooltip.top="'Enter Store Name'" placeholder="Filter Store Here" />
              </span>
            </div>
          </div>
        </div>

        <!-- Dynamic Data Display Based on Selected Tab -->
        <div v-if="index === 0">
          <div class="tables-row">
            <div class="table-card">
              <h3>The Most Viewed Stores</h3>
              <DataTable
                :value="mostViewedStores"
                paginator
                :rows="10"
                responsiveLayout="scroll"
                class="styled-table"
              >
                <Column field="id" header="#"></Column>
                <Column field="store" header="Store"></Column>
                <Column field="bestRate" header="Best Rate"></Column>
              </DataTable>
            </div>

            <div class="table-card">
              <h3>Stores Sorted by Rewards</h3>
              <DataTable
                :value="storesSortedByRewards"
                paginator
                :rows="10"
                responsiveLayout="scroll"
                class="styled-table"
              >
                <Column field="id" header="#"></Column>
                <Column field="store" header="Store"></Column>
                <Column field="bestRate" header="Best Rate"></Column>
              </DataTable>
            </div>
          </div>
        </div>

        <div v-else-if="index === 1">
          <DataTable
            :value="cashbackData"
            paginator
            :rows="10"
            responsiveLayout="scroll"
            class="styled-table"
          >
            <Column field="store" header="Store"></Column>
            <Column field="bestRate" header="Best Rate"></Column>
            <Column field="beFrugal" header="BeFrugal"></Column>
            <Column field="extraBux" header="ExtraBux"></Column>
          </DataTable>
        </div>

        <div v-else-if="index === 2">
          <DataTable
            :value="travelMilesData"
            paginator
            :rows="10"
            responsiveLayout="scroll"
            class="styled-table"
          >
            <Column field="store" header="Store"></Column>
            <Column field="bestRate" header="Best Rate"></Column>
            <Column field="alaska" header="Alaska Mileage Plan"></Column>
            <Column field="american" header="American AAdvantage"></Column>
          </DataTable>
        </div>

        <div v-else-if="index === 3">
          <DataTable
            :value="creditCardPoints"
            paginator
            :rows="10"
            responsiveLayout="scroll"
            class="styled-table"
          >
            <Column field="store" header="Store"></Column>
            <Column field="bestRate" header="Best Rate"></Column>
            <Column field="alaska" header="Alaska Mileage Plan"></Column>
            <Column field="american" header="American AAdvantage"></Column>
          </DataTable>
        </div>

        <div v-else-if="index === 4">
          <DataTable
            :value="otherRewardPoints"
            paginator
            :rows="10"
            responsiveLayout="scroll"
            class="styled-table"
          >
            <Column field="store" header="Store"></Column>
            <Column field="bestRate" header="Best Rate"></Column>
            <Column field="alaska" header="Alaska Mileage Plan"></Column>
            <Column field="american" header="American AAdvantage"></Column>
          </DataTable>
        </div>
      </TabPanel>
    </TabView>
  </div>
</template>

<style scoped>
  .card {
    padding: 20px;
  }

  .tables-row {
    display: flex;
    justify-content: space-between;
  }

  .table-card {
    width: 48%;
    background: white;
    padding: 15px;
    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
    border-radius: 8px;
  }

  .filter-section {
    margin-bottom: 20px;
  }

  .filt {
    font-size: 1.2em;
  }

  .letters span {
    margin-right: 8px;
    cursor: pointer;
  }

  .search-bar {
    margin-top: 10px;
  }

  .gray-box {
    display: inline-block;
    width: 10px;
    height: 10px;
    background: gray;
    margin-right: 5px;
  }

  .green-box {
    display: inline-block;
    width: 10px;
    height: 10px;
    background: green;
    margin-right: 5px;
  }
</style>
